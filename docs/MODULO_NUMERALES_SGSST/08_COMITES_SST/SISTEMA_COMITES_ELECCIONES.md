# Sistema de ConformaciÃ³n de ComitÃ©s SST

## Fecha: 2026-02-03
## VersiÃ³n: 1.0

---

## Resumen Ejecutivo

Sistema integral para la conformaciÃ³n de comitÃ©s de Seguridad y Salud en el Trabajo:
- **COPASST** (ComitÃ© Paritario de Seguridad y Salud en el Trabajo)
- **COCOLAB** (ComitÃ© de Convivencia Laboral)
- **Brigada de Emergencias** (integral)
- **VigÃ­a SST** (empresas de 1-9 trabajadores)

El sistema gestiona todo el ciclo de vida: inscripciÃ³n de candidatos, votaciÃ³n electrÃ³nica, escrutinio automÃ¡tico, generaciÃ³n de documentos y firmas electrÃ³nicas.

---

## Marco Normativo

### COPASST
| Normativa | DescripciÃ³n |
|-----------|-------------|
| ResoluciÃ³n 2013/1986 | ConformaciÃ³n de comitÃ©s paritarios |
| Decreto 1072/2015 | Decreto Ãšnico Reglamentario del Sector Trabajo |
| ResoluciÃ³n 0312/2019 | EstÃ¡ndares MÃ­nimos del SG-SST |

### COCOLAB
| Normativa | DescripciÃ³n |
|-----------|-------------|
| ResoluciÃ³n 652/2012 | ConformaciÃ³n del ComitÃ© de Convivencia |
| ResoluciÃ³n 1356/2012 | Modificaciones a la 652 |
| ResoluciÃ³n 3461/2025 | ActualizaciÃ³n de conformaciÃ³n por tamaÃ±o |

### Brigadas
| Normativa | DescripciÃ³n |
|-----------|-------------|
| Decreto 1072/2015 | Plan de emergencias y brigadas |
| ResoluciÃ³n 0312/2019 | EstÃ¡ndar de conformaciÃ³n de brigadas |

---

## ConformaciÃ³n por TamaÃ±o de Empresa

### COPASST

| # Trabajadores | Empleador | Trabajadores | Total Principales | ObservaciÃ³n |
|----------------|-----------|--------------|-------------------|-------------|
| 1 - 9 | - | - | 1 (VigÃ­a) | No hay comitÃ©, se designa VigÃ­a |
| 10 - 49 | 1 | 1 | 2 | + suplentes |
| 50 - 499 | 2 | 2 | 4 | + suplentes |
| 500 - 999 | 3 o 4 | 3 o 4 | 6 u 8 | Recomendado 4+4 |
| 1000+ | 4 | 4 | 8 | + suplentes |

> **Nota:** Siempre paridad (igual nÃºmero empleador/trabajador). Suplentes en igual cantidad que principales.

### COCOLAB (ResoluciÃ³n 3461/2025)

| # Trabajadores | Empleador | Trabajadores | Total Principales |
|----------------|-----------|--------------|-------------------|
| < 5 | 1 | 1 | 2 |
| 5 a < 20 | 1 | 1 | 2 |
| >= 20 | 2 | 2 | 4 |

### Brigada de Emergencias

No tiene conformaciÃ³n paritaria. Se conforma por:
- Voluntariado de trabajadores
- DesignaciÃ³n del empleador
- Una sola brigada integral (primeros auxilios, evacuaciÃ³n, incendios)

---

## Flujos de ConformaciÃ³n

### Flujo COPASST / COCOLAB (con votaciÃ³n)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PROCESO DE CONFORMACIÃ“N                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ INSCRIPCIÃ“N  â”‚â”€â”€â”€>â”‚  VOTACIÃ“N    â”‚â”€â”€â”€>â”‚  ESCRUTINIO  â”‚â”€â”€â”€>â”‚   FIRMAS   â”‚ â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚    â”‚            â”‚ â”‚
â”‚  â”‚ - Candidatos â”‚    â”‚ - Enlace 24h â”‚    â”‚ - Conteo     â”‚    â”‚ - Miembros â”‚ â”‚
â”‚  â”‚ - Jurados    â”‚    â”‚ - CÃ©dula     â”‚    â”‚ - Resultados â”‚    â”‚ - Delegado â”‚ â”‚
â”‚  â”‚              â”‚    â”‚ - 1 voto     â”‚    â”‚ - Ganadores  â”‚    â”‚ - Rep Legalâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                   â”‚                   â”‚                   â”‚       â”‚
â”‚         â–¼                   â–¼                   â–¼                   â–¼       â”‚
â”‚    Doc: Acta de       Doc: Registro       Doc: Acta de        Doc: Acta de â”‚
â”‚    Apertura           de Votantes         Cierre/Resultados   ConstituciÃ³n â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flujo Brigada / VigÃ­a (sin votaciÃ³n)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PROCESO DE DESIGNACIÃ“N                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  VOLUNTARIADO    â”‚â”€â”€â”€>â”‚   DESIGNACIÃ“N    â”‚â”€â”€â”€>â”‚     FIRMAS       â”‚       â”‚
â”‚  â”‚                  â”‚    â”‚                  â”‚    â”‚                  â”‚       â”‚
â”‚  â”‚ - Registro       â”‚    â”‚ - Rep Legal      â”‚    â”‚ - Designados     â”‚       â”‚
â”‚  â”‚ - Voluntarios    â”‚    â”‚   selecciona     â”‚    â”‚ - Rep Legal      â”‚       â”‚
â”‚  â”‚                  â”‚    â”‚ - Asigna roles   â”‚    â”‚ - Delegado SST   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚          â”‚                       â”‚                       â”‚                  â”‚
â”‚          â–¼                       â–¼                       â–¼                  â”‚
â”‚     Listado de             Doc: Acta de            Documento con            â”‚
â”‚     Voluntarios            DesignaciÃ³n             firmas completas         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Estados del Proceso Electoral

| Estado | DescripciÃ³n | Acciones Disponibles |
|--------|-------------|---------------------|
| `configuracion` | Consultor configura parÃ¡metros del proceso | Definir fechas, nÃºmero de plazas |
| `inscripcion` | PerÃ­odo de inscripciÃ³n de candidatos y jurados | Registrar candidatos, registrar jurados |
| `votacion` | VotaciÃ³n abierta (enlace activo 24h) | Votar (trabajadores) |
| `escrutinio` | Conteo y publicaciÃ³n de resultados | Ver resultados, resolver empates |
| `designacion_empleador` | Rep Legal designa sus representantes | Registrar rep. empleador |
| `firmas` | Proceso de firmas electrÃ³nicas | Firmar documentos |
| `completado` | ComitÃ© conformado y documentos firmados | Descargar documentos |

---

## Documentos Generados

### COPASST / COCOLAB

| # | Documento | Momento | Firmantes |
|---|-----------|---------|-----------|
| 1 | Acta de Apertura de Elecciones | Al abrir inscripciÃ³n | Jurados |
| 2 | Registro de Votantes | Durante votaciÃ³n | Auto-generado |
| 3 | Acta de Cierre de Votaciones | Al cerrar votaciÃ³n | Jurados |
| 4 | Resultados de VotaciÃ³n | Post-escrutinio | Jurados |
| 5 | Acta de ConstituciÃ³n del ComitÃ© | Final | Todos los miembros + Delegado SST + Rep Legal |

### Brigada de Emergencias

| # | Documento | Momento | Firmantes |
|---|-----------|---------|-----------|
| 1 | Acta de DesignaciÃ³n de Brigada | Al designar | Brigadistas + Rep Legal + Delegado SST |

### VigÃ­a SST

| # | Documento | Momento | Firmantes |
|---|-----------|---------|-----------|
| 1 | Acta de DesignaciÃ³n de VigÃ­a | Al designar | VigÃ­a + Rep Legal + Delegado SST |

---

## Arquitectura de Base de Datos

### Tablas Existentes (reutilizar)

```
tbl_comites              â†’ Almacena los comitÃ©s con perÃ­odo de vigencia
tbl_comite_miembros      â†’ Miembros del comitÃ© (principales/suplentes)
tbl_tipos_comite         â†’ Tipos: COPASST, COCOLAB, VIGIA, BRIGADA
tbl_doc_firma_solicitudes â†’ Sistema de firmas electrÃ³nicas
tbl_doc_firma_evidencias  â†’ Evidencias de firmas
```

### Nuevas Tablas (YA CREADAS EN LOCAL Y PRODUCCIÃ“N)

> **Nota:** Estas tablas fueron creadas el 2026-02-03 tanto en la base de datos local como en producciÃ³n (DigitalOcean).

#### `tbl_procesos_electorales`

Almacena cada proceso de conformaciÃ³n de comitÃ©.

```sql
CREATE TABLE tbl_procesos_electorales (
    id_proceso INT AUTO_INCREMENT PRIMARY KEY,
    id_cliente INT NOT NULL,
    id_comite INT NULL,
    tipo_comite ENUM('COPASST', 'COCOLAB', 'BRIGADA', 'VIGIA') NOT NULL,
    anio INT NOT NULL,
    estado ENUM('configuracion', 'inscripcion', 'votacion', 'escrutinio',
                'designacion_empleador', 'firmas', 'completado', 'cancelado')
                DEFAULT 'configuracion',
    plazas_principales INT NOT NULL DEFAULT 2,
    plazas_suplentes INT NOT NULL DEFAULT 2,
    fecha_inicio_inscripcion DATETIME NULL,
    fecha_fin_inscripcion DATETIME NULL,
    fecha_inicio_votacion DATETIME NULL,
    fecha_fin_votacion DATETIME NULL,
    fecha_escrutinio DATETIME NULL,
    fecha_completado DATETIME NULL,
    token_votacion VARCHAR(64) UNIQUE NULL,
    fecha_inicio_periodo DATE NULL,
    fecha_fin_periodo DATE NULL,
    id_consultor INT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### `tbl_participantes_comite` (TABLA UNIFICADA)

Almacena tanto candidatos de trabajadores (votaciÃ³n) como representantes del empleador (designaciÃ³n) en una sola tabla.

```sql
CREATE TABLE tbl_participantes_comite (
    id_participante INT AUTO_INCREMENT PRIMARY KEY,
    id_proceso INT NOT NULL,

    -- Datos personales (comunes a todos)
    nombre_completo VARCHAR(200) NOT NULL,
    tipo_documento VARCHAR(10) DEFAULT 'CC',
    numero_documento VARCHAR(20) NOT NULL,
    cargo VARCHAR(100) NOT NULL,
    area_dependencia VARCHAR(100) NULL,
    email VARCHAR(150) NOT NULL,
    telefono VARCHAR(20) NULL,
    foto_url VARCHAR(500) NOT NULL,              -- Foto obligatoria

    -- CertificaciÃ³n 50 horas (obligatorio por ley para COPASST)
    certificado_50_horas_url VARCHAR(500) NULL,
    certificado_50_horas_fecha DATE NULL,
    certificado_50_horas_institucion VARCHAR(200) NULL,

    -- Tipo de participaciÃ³n
    representacion ENUM('empleador', 'trabajador') NOT NULL,
    origen ENUM('votacion', 'designacion') NOT NULL,

    -- Campos para votaciÃ³n (NULL si es designaciÃ³n)
    votos_obtenidos INT DEFAULT 0,
    es_ganador TINYINT(1) DEFAULT 0,
    orden_resultado INT NULL,

    -- AsignaciÃ³n final
    tipo_miembro ENUM('principal', 'suplente', 'reserva', 'no_electo', 'pendiente') DEFAULT 'pendiente',
    rol_comite ENUM('presidente', 'secretario', 'miembro') DEFAULT 'miembro',

    -- Transferencia a comitÃ©
    transferido_a_comite TINYINT(1) DEFAULT 0,
    id_miembro_comite INT NULL,
    fecha_transferencia DATETIME NULL,

    -- Estado
    estado ENUM('inscrito', 'activo', 'retirado') DEFAULT 'inscrito',
    fecha_registro DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    UNIQUE KEY unique_participante_proceso (id_proceso, numero_documento)
);
```

**Ventajas de la tabla unificada:**
- Consulta simple para todos los participantes de un proceso
- Campo `certificado_50_horas_url` disponible para todos (empleador y trabajadores)
- VerificaciÃ³n de paridad con un solo `GROUP BY representacion`
- Evita duplicaciÃ³n de lÃ³gica de negocio

#### `tbl_jurados_eleccion`

Jurados de votaciÃ³n (mÃ­nimo 2, sin mÃ¡ximo).

```sql
CREATE TABLE tbl_jurados_eleccion (
    id_jurado INT AUTO_INCREMENT PRIMARY KEY,
    id_proceso INT NOT NULL,

    -- Datos del jurado
    nombre_completo VARCHAR(200) NOT NULL,
    tipo_documento VARCHAR(10) DEFAULT 'CC',
    numero_documento VARCHAR(20) NOT NULL,
    cargo VARCHAR(100) NOT NULL,
    area_dependencia VARCHAR(100) NULL,
    email VARCHAR(150) NOT NULL,

    -- Rol en el proceso
    rol ENUM('presidente_mesa', 'secretario_mesa', 'testigo') DEFAULT 'testigo',

    -- Firma
    ha_firmado TINYINT(1) DEFAULT 0,
    fecha_firma DATETIME NULL,

    -- Estado
    estado ENUM('activo', 'retirado') DEFAULT 'activo',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (id_proceso) REFERENCES tbl_procesos_electorales(id_proceso),
    UNIQUE KEY unique_jurado_proceso (id_proceso, numero_documento)
);
```

#### `tbl_votos_eleccion`

Registro de votos (anÃ³nimo pero validable).

```sql
CREATE TABLE tbl_votos_eleccion (
    id_voto INT AUTO_INCREMENT PRIMARY KEY,
    id_proceso INT NOT NULL,
    id_candidato INT NOT NULL,

    -- ValidaciÃ³n del votante (hash para evitar duplicados sin revelar identidad)
    hash_votante VARCHAR(64) NOT NULL,           -- SHA256(cedula + id_proceso + salt)

    -- AuditorÃ­a
    ip_votante VARCHAR(45) NULL,
    user_agent TEXT NULL,
    fecha_voto DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (id_proceso) REFERENCES tbl_procesos_electorales(id_proceso),
    FOREIGN KEY (id_candidato) REFERENCES tbl_candidatos_eleccion(id_candidato),
    UNIQUE KEY unique_votante_proceso (id_proceso, hash_votante)
);
```

#### `tbl_representantes_empleador`

Representantes designados por el empleador (no votan).

```sql
CREATE TABLE tbl_representantes_empleador (
    id_representante INT AUTO_INCREMENT PRIMARY KEY,
    id_proceso INT NOT NULL,

    -- Datos
    nombre_completo VARCHAR(200) NOT NULL,
    tipo_documento VARCHAR(10) DEFAULT 'CC',
    numero_documento VARCHAR(20) NOT NULL,
    cargo VARCHAR(100) NOT NULL,
    area_dependencia VARCHAR(100) NULL,
    email VARCHAR(150) NOT NULL,

    -- Tipo
    tipo_miembro ENUM('principal', 'suplente') NOT NULL,

    -- Estado
    estado ENUM('activo', 'retirado') DEFAULT 'activo',
    fecha_designacion DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (id_proceso) REFERENCES tbl_procesos_electorales(id_proceso),
    UNIQUE KEY unique_rep_proceso (id_proceso, numero_documento)
);
```

#### `tbl_voluntarios_brigada`

Voluntarios para brigada de emergencias.

```sql
CREATE TABLE tbl_voluntarios_brigada (
    id_voluntario INT AUTO_INCREMENT PRIMARY KEY,
    id_proceso INT NOT NULL,

    -- Datos
    nombre_completo VARCHAR(200) NOT NULL,
    tipo_documento VARCHAR(10) DEFAULT 'CC',
    numero_documento VARCHAR(20) NOT NULL,
    cargo VARCHAR(100) NOT NULL,
    area_dependencia VARCHAR(100) NULL,
    email VARCHAR(150) NOT NULL,
    foto_url VARCHAR(500) NULL,

    -- DesignaciÃ³n
    fue_designado TINYINT(1) DEFAULT 0,
    rol_brigada VARCHAR(100) NULL,               -- Ej: "Coordinador", "Primeros auxilios"
    fecha_designacion DATETIME NULL,

    -- Estado
    estado ENUM('voluntario', 'designado', 'retirado') DEFAULT 'voluntario',
    fecha_registro DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (id_proceso) REFERENCES tbl_procesos_electorales(id_proceso)
);
```

#### `tbl_documentos_proceso_electoral`

Documentos generados en cada proceso.

```sql
CREATE TABLE tbl_documentos_proceso_electoral (
    id_documento_proceso INT AUTO_INCREMENT PRIMARY KEY,
    id_proceso INT NOT NULL,

    -- Tipo de documento
    tipo_documento ENUM(
        'acta_apertura',
        'registro_votantes',
        'acta_cierre',
        'resultados_votacion',
        'acta_constitucion',
        'acta_designacion_brigada',
        'acta_designacion_vigia'
    ) NOT NULL,

    -- Archivo
    archivo_pdf VARCHAR(500) NULL,
    archivo_word VARCHAR(500) NULL,

    -- Estado de firmas
    estado_firmas ENUM('pendiente', 'en_proceso', 'completado') DEFAULT 'pendiente',
    id_solicitud_firma INT NULL,                 -- FK a tbl_doc_firma_solicitudes

    -- Timestamps
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (id_proceso) REFERENCES tbl_procesos_electorales(id_proceso),
    FOREIGN KEY (id_solicitud_firma) REFERENCES tbl_doc_firma_solicitudes(id_solicitud)
);
```

### Diagrama de Relaciones

```
tbl_clientes (1)
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> (N) tbl_procesos_electorales
       â”‚                                          â”‚
       â”‚                                          â”œâ”€â”€> (N) tbl_candidatos_eleccion
       â”‚                                          â”‚           â”‚
       â”‚                                          â”‚           â””â”€â”€> (N) tbl_votos_eleccion
       â”‚                                          â”‚
       â”‚                                          â”œâ”€â”€> (N) tbl_jurados_eleccion
       â”‚                                          â”‚
       â”‚                                          â”œâ”€â”€> (N) tbl_representantes_empleador
       â”‚                                          â”‚
       â”‚                                          â”œâ”€â”€> (N) tbl_voluntarios_brigada
       â”‚                                          â”‚
       â”‚                                          â”œâ”€â”€> (N) tbl_documentos_proceso_electoral
       â”‚                                          â”‚           â”‚
       â”‚                                          â”‚           â””â”€â”€> tbl_doc_firma_solicitudes
       â”‚                                          â”‚
       â”‚                                          â””â”€â”€> (1) tbl_comites
       â”‚                                                      â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> (N) tbl_comite_miembros
```

---

## Reglas de Negocio

### VotaciÃ³n

1. **Un voto por trabajador:** Validado por hash de cÃ©dula
2. **Un candidato por voto:** No se puede votar por mÃºltiples
3. **Sin quÃ³rum mÃ­nimo:** No hay mÃ­nimo de participaciÃ³n requerido
4. **Enlace temporal:** 24 horas de vigencia, definido por consultor
5. **Acceso universal:** Cualquier dispositivo, cualquier ubicaciÃ³n

### Resultados

1. **Ganadores por votos:** Los N candidatos con mÃ¡s votos son principales
2. **Suplentes automÃ¡ticos:** Los siguientes en votos son suplentes
3. **Desempate por concertaciÃ³n:** Los empatados deciden entre ellos (queda en acta)
4. **Lista de reserva:** Candidatos no electos quedan como elegibles para reemplazo

**Texto legal para acta de desempate:**
> "En caso de empate entre candidatos a representantes de los trabajadores que exceda el nÃºmero de plazas disponibles, los candidatos empatados deliberarÃ¡n y concertarÃ¡n entre ellos quiÃ©n ocuparÃ¡ la(s) plaza(s) correspondiente(s). Los demÃ¡s candidatos empatados quedarÃ¡n registrados como elegibles y podrÃ¡n ocupar la vacante en caso de retiro, desvinculaciÃ³n laboral, incapacidad prolongada o cualquier situaciÃ³n que genere descomposiciÃ³n del comitÃ© durante el perÃ­odo."

### Firmas

**Orden de firma para Acta de ConstituciÃ³n:**
1. Miembros principales (en orden alfabÃ©tico)
2. Miembros suplentes (en orden alfabÃ©tico)
3. Delegado SST
4. Representante Legal

**Orden de firma para documentos de jurados:**
1. Jurados (en orden de rol: presidente, secretario, testigos)

---

## Interfaz de Usuario

### Dashboard del Proceso (Consultor)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ—³ï¸ COPASST 2026-2028 - Empresa XYZ                                         â”‚
â”‚ Estado: INSCRIPCIÃ“N                                                âš™ï¸ Config â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ðŸ“          â”‚  â”‚ ðŸ—³ï¸          â”‚  â”‚ ðŸ“Š          â”‚  â”‚ âœï¸          â”‚        â”‚
â”‚  â”‚ InscripciÃ³n â”‚  â”‚ VotaciÃ³n    â”‚  â”‚ Escrutinio  â”‚  â”‚ Firmas      â”‚        â”‚
â”‚  â”‚ âœ… Activo   â”‚  â”‚ â³ Pendiente â”‚  â”‚ â³ Pendiente â”‚  â”‚ â³ Pendiente â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ“‹ Candidatos Inscritos (5)                        [+ Nuevo Candidato]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ Foto â”‚ Nombre          â”‚ CÃ©dula      â”‚ Cargo        â”‚ Ãrea      â”‚ Estado â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ ðŸ‘¤   â”‚ Juan PÃ©rez      â”‚ 1234567890  â”‚ Operario     â”‚ ProducciÃ³nâ”‚ âœ…     â”‚
â”‚ â”‚ ðŸ‘¤   â”‚ MarÃ­a GarcÃ­a    â”‚ 0987654321  â”‚ Asistente    â”‚ RRHH      â”‚ âœ…     â”‚
â”‚ â”‚ ...                                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ‘¥ Jurados (2)                                      [+ Nuevo Jurado]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ Nombre          â”‚ CÃ©dula      â”‚ Rol              â”‚ Email                  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â”‚ Carlos LÃ³pez    â”‚ 1122334455  â”‚ Presidente Mesa  â”‚ carlos@empresa.com     â”‚
â”‚ â”‚ Ana RodrÃ­guez   â”‚ 5544332211  â”‚ Secretario Mesa  â”‚ ana@empresa.com        â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    [ðŸ“¤ Abrir VotaciÃ³n]  [âŒ Cancelar Proceso]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Pantalla de VotaciÃ³n (Trabajador - Mobile First)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ðŸ—³ï¸ VOTACIÃ“N COPASST 2026    â”‚
â”‚          Empresa XYZ            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  Ingrese su cÃ©dula:             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ 1234567890                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                 â”‚
â”‚  [      Continuar       ]       â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          â†“ (tras validar)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ðŸ—³ï¸ VOTACIÃ“N COPASST 2026    â”‚
â”‚     Seleccione UN candidato     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ðŸ‘¤ Juan PÃ©rez              â”‚â”‚
â”‚  â”‚  Operario - ProducciÃ³n      â”‚â”‚
â”‚  â”‚  [    Votar por Juan   ]    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ðŸ‘¤ MarÃ­a GarcÃ­a            â”‚â”‚
â”‚  â”‚  Asistente - RRHH           â”‚â”‚
â”‚  â”‚  [   Votar por MarÃ­a   ]    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ðŸ‘¤ Pedro SÃ¡nchez           â”‚â”‚
â”‚  â”‚  TÃ©cnico - Mantenimiento    â”‚â”‚
â”‚  â”‚  [   Votar por Pedro   ]    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          â†“ (tras votar)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚         âœ… Â¡VOTO REGISTRADO!    â”‚
â”‚                                 â”‚
â”‚   Gracias por participar en    â”‚
â”‚   la elecciÃ³n del COPASST.     â”‚
â”‚                                 â”‚
â”‚   Su voto ha sido registrado   â”‚
â”‚   de forma anÃ³nima y segura.   â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Pantalla de Resultados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“Š RESULTADOS VOTACIÃ“N COPASST 2026                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Total votantes: 45 de 120 trabajadores (37.5%)                             â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ # â”‚ Candidato     â”‚ Votos â”‚ %     â”‚ GrÃ¡fica                â”‚ Resultado â”‚â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 1 â”‚ Juan PÃ©rez    â”‚  15   â”‚ 33.3% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚ PRINCIPAL â”‚â”‚
â”‚  â”‚ 2 â”‚ MarÃ­a GarcÃ­a  â”‚  12   â”‚ 26.7% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ            â”‚ PRINCIPAL â”‚â”‚
â”‚  â”‚ 3 â”‚ Pedro SÃ¡nchez â”‚   9   â”‚ 20.0% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ               â”‚ SUPLENTE  â”‚â”‚
â”‚  â”‚ 4 â”‚ Ana LÃ³pez     â”‚   5   â”‚ 11.1% â”‚ â–ˆâ–ˆâ–ˆâ–ˆ                   â”‚ SUPLENTE  â”‚â”‚
â”‚  â”‚ 5 â”‚ Luis GÃ³mez    â”‚   4   â”‚  8.9% â”‚ â–ˆâ–ˆâ–ˆ                    â”‚ RESERVA   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  â˜‘ï¸ Juan PÃ©rez      â˜‘ï¸ MarÃ­a GarcÃ­a      [Transferir a ComitÃ©]              â”‚
â”‚  â˜‘ï¸ Pedro SÃ¡nchez   â˜‘ï¸ Ana LÃ³pez                                            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## IntegraciÃ³n con Sistema de Firmas

### Tipo de Firma para Acta de ConstituciÃ³n

El Acta de ConstituciÃ³n requiere firma tipo **F** o **G** (mÃºltiples firmantes con Delegado SST).

SegÃºn `SISTEMA_FIRMAS_DOCUMENTOS.md`, el flujo es:

```php
// Crear solicitud de firma para Acta de ConstituciÃ³n
$solicitudFirma = [
    'id_documento' => $idDocumento,
    'tipo_documento' => 'acta_constitucion_copasst',
    'tipo_firma' => 'F',  // MÃºltiples firmantes
    'requiere_delegado_sst' => 1,
    'estado' => 'pendiente'
];
```

**Orden de firma (secuencial):**
1. Miembros del comitÃ© (principales y suplentes) - `orden_firma: 1, 2, 3...`
2. Delegado SST - `orden_firma: N+1, estado: 'esperando'`
3. Representante Legal - `orden_firma: N+2, estado: 'esperando'`

### IntegraciÃ³n con `tbl_doc_firma_solicitudes`

```sql
-- Al crear solicitud de firma para Acta de ConstituciÃ³n
INSERT INTO tbl_doc_firma_solicitudes (
    id_documento,
    tipo_documento,
    tipo_firma,
    requiere_delegado_sst,
    estado
) VALUES (
    :id_documento,
    'acta_constitucion_copasst',
    'F',
    1,
    'pendiente'
);

-- Agregar firmantes
INSERT INTO tbl_doc_firma_evidencias (
    id_solicitud,
    nombre_firmante,
    email_firmante,
    cedula_firmante,
    cargo_firmante,
    orden_firma,
    estado
) VALUES
    (:id_solicitud, 'Juan PÃ©rez', 'juan@...', '123...', 'Miembro Principal', 1, 'pendiente'),
    (:id_solicitud, 'MarÃ­a GarcÃ­a', 'maria@...', '098...', 'Miembro Principal', 2, 'pendiente'),
    -- ... mÃ¡s miembros
    (:id_solicitud, 'Delegado SST', 'delegado@...', '...', 'Delegado SST', 9, 'esperando'),
    (:id_solicitud, 'Rep Legal', 'rep@...', '...', 'Representante Legal', 10, 'esperando');
```

---

## Controladores y Rutas

### Nuevo Controlador: `ComitesEleccionesController.php`

```php
class ComitesEleccionesController extends BaseController
{
    // Dashboard del proceso
    public function dashboard($idCliente, $idProceso = null);

    // GestiÃ³n de procesos
    public function nuevoProceso($idCliente);
    public function guardarProceso();
    public function configurarProceso($idProceso);
    public function cancelarProceso($idProceso);

    // Candidatos
    public function nuevoCandidato($idProceso);
    public function guardarCandidato();
    public function retirarCandidato($idCandidato);

    // Jurados
    public function nuevoJurado($idProceso);
    public function guardarJurado();

    // VotaciÃ³n
    public function abrirVotacion($idProceso);
    public function cerrarVotacion($idProceso);
    public function pantallaVotacion($token);           // PÃºblica
    public function validarVotante($token);             // AJAX
    public function registrarVoto($token);              // AJAX

    // Escrutinio
    public function verResultados($idProceso);
    public function resolverEmpate($idProceso);
    public function transferirAComite($idProceso);      // Mover ganadores a tbl_comite_miembros

    // Representantes empleador
    public function designarRepresentanteEmpleador($idProceso);
    public function guardarRepresentanteEmpleador();

    // Documentos
    public function generarDocumento($idProceso, $tipo);
    public function descargarDocumento($idDocumentoProceso);

    // Firmas
    public function iniciarProcesoFirmas($idDocumentoProceso);
    public function estadoFirmas($idProceso);
}
```

### Nuevo Controlador: `BrigadasController.php`

```php
class BrigadasController extends BaseController
{
    // Dashboard
    public function dashboard($idCliente, $idProceso = null);

    // Voluntarios
    public function registrarVoluntario($idProceso);
    public function guardarVoluntario();

    // DesignaciÃ³n
    public function designarBrigadistas($idProceso);
    public function guardarDesignacion();

    // Documento
    public function generarActaDesignacion($idProceso);
}
```

### Rutas Propuestas

```php
// ComitÃ©s con elecciÃ³n (COPASST, COCOLAB)
$routes->group('comites-elecciones', ['filter' => 'auth'], function($routes) {
    $routes->get('(:num)', 'ComitesEleccionesController::dashboard/$1');
    $routes->get('(:num)/proceso/(:num)', 'ComitesEleccionesController::dashboard/$1/$2');
    $routes->get('(:num)/nuevo', 'ComitesEleccionesController::nuevoProceso/$1');
    $routes->post('proceso/guardar', 'ComitesEleccionesController::guardarProceso');

    // Candidatos
    $routes->get('proceso/(:num)/candidato/nuevo', 'ComitesEleccionesController::nuevoCandidato/$1');
    $routes->post('candidato/guardar', 'ComitesEleccionesController::guardarCandidato');

    // Jurados
    $routes->get('proceso/(:num)/jurado/nuevo', 'ComitesEleccionesController::nuevoJurado/$1');
    $routes->post('jurado/guardar', 'ComitesEleccionesController::guardarJurado');

    // Control de votaciÃ³n
    $routes->post('proceso/(:num)/abrir-votacion', 'ComitesEleccionesController::abrirVotacion/$1');
    $routes->post('proceso/(:num)/cerrar-votacion', 'ComitesEleccionesController::cerrarVotacion/$1');

    // Resultados y transferencia
    $routes->get('proceso/(:num)/resultados', 'ComitesEleccionesController::verResultados/$1');
    $routes->post('proceso/(:num)/transferir-comite', 'ComitesEleccionesController::transferirAComite/$1');

    // Representantes empleador
    $routes->get('proceso/(:num)/rep-empleador/nuevo', 'ComitesEleccionesController::designarRepresentanteEmpleador/$1');
    $routes->post('rep-empleador/guardar', 'ComitesEleccionesController::guardarRepresentanteEmpleador');

    // Documentos
    $routes->get('proceso/(:num)/documento/(:segment)', 'ComitesEleccionesController::generarDocumento/$1/$2');
});

// VotaciÃ³n pÃºblica (sin auth, con token)
$routes->get('votar/(:alphanum)', 'ComitesEleccionesController::pantallaVotacion/$1');
$routes->post('votar/(:alphanum)/validar', 'ComitesEleccionesController::validarVotante/$1');
$routes->post('votar/(:alphanum)/registrar', 'ComitesEleccionesController::registrarVoto/$1');

// Brigadas
$routes->group('brigadas', ['filter' => 'auth'], function($routes) {
    $routes->get('(:num)', 'BrigadasController::dashboard/$1');
    $routes->get('(:num)/proceso/(:num)', 'BrigadasController::dashboard/$1/$2');
    $routes->post('voluntario/registrar', 'BrigadasController::guardarVoluntario');
    $routes->post('proceso/(:num)/designar', 'BrigadasController::guardarDesignacion');
    $routes->get('proceso/(:num)/acta', 'BrigadasController::generarActaDesignacion/$1');
});

// VigÃ­a SST (similar a brigadas)
$routes->group('vigia-sst', ['filter' => 'auth'], function($routes) {
    $routes->get('(:num)', 'VigiaSSTController::dashboard/$1');
    $routes->post('designar', 'VigiaSSTController::guardarDesignacion');
    $routes->get('proceso/(:num)/acta', 'VigiaSSTController::generarActaDesignacion/$1');
});
```

---

## Seguridad de VotaciÃ³n

### ValidaciÃ³n de Votante

```php
public function validarVotante($token)
{
    $cedula = $this->request->getPost('cedula');
    $proceso = $this->getProcesoByToken($token);

    // Verificar que el proceso estÃ© en estado 'votacion'
    if ($proceso['estado'] !== 'votacion') {
        return $this->response->setJSON(['error' => 'VotaciÃ³n no disponible']);
    }

    // Verificar que no haya votado antes
    $hashVotante = hash('sha256', $cedula . $proceso['id_proceso'] . VOTE_SALT);
    $yaVoto = $this->db->table('tbl_votos_eleccion')
        ->where('id_proceso', $proceso['id_proceso'])
        ->where('hash_votante', $hashVotante)
        ->countAllResults();

    if ($yaVoto > 0) {
        return $this->response->setJSON(['error' => 'Ya registrÃ³ su voto']);
    }

    // Retornar candidatos
    $candidatos = $this->getCandidatosActivos($proceso['id_proceso']);
    return $this->response->setJSON(['success' => true, 'candidatos' => $candidatos]);
}
```

### Registro de Voto (AnÃ³nimo)

```php
public function registrarVoto($token)
{
    $cedula = $this->request->getPost('cedula');
    $idCandidato = $this->request->getPost('id_candidato');
    $proceso = $this->getProcesoByToken($token);

    // Crear hash anÃ³nimo
    $hashVotante = hash('sha256', $cedula . $proceso['id_proceso'] . VOTE_SALT);

    // Registrar voto
    $this->db->table('tbl_votos_eleccion')->insert([
        'id_proceso' => $proceso['id_proceso'],
        'id_candidato' => $idCandidato,
        'hash_votante' => $hashVotante,
        'ip_votante' => $this->request->getIPAddress(),
        'user_agent' => $this->request->getUserAgent()->getAgentString()
    ]);

    // Incrementar contador del candidato
    $this->db->table('tbl_candidatos_eleccion')
        ->where('id_candidato', $idCandidato)
        ->set('votos_obtenidos', 'votos_obtenidos + 1', false)
        ->update();

    return $this->response->setJSON(['success' => true]);
}
```

---

## Vistas Principales

```
app/Views/comites_elecciones/
â”œâ”€â”€ dashboard.php              // Panel principal del proceso
â”œâ”€â”€ nuevo_proceso.php          // Crear nuevo proceso electoral
â”œâ”€â”€ configurar_proceso.php     // Configurar fechas y plazas
â”œâ”€â”€ candidatos/
â”‚   â”œâ”€â”€ lista.php              // Tabla de candidatos
â”‚   â”œâ”€â”€ nuevo.php              // Formulario nuevo candidato
â”‚   â””â”€â”€ tarjeta.php            // Card de candidato (componente)
â”œâ”€â”€ jurados/
â”‚   â”œâ”€â”€ lista.php              // Tabla de jurados
â”‚   â””â”€â”€ nuevo.php              // Formulario nuevo jurado
â”œâ”€â”€ votacion/
â”‚   â”œâ”€â”€ publica.php            // Pantalla de votaciÃ³n (pÃºblica)
â”‚   â”œâ”€â”€ validar_cedula.php     // Modal/pantalla validaciÃ³n
â”‚   â””â”€â”€ confirmacion.php       // Voto registrado
â”œâ”€â”€ resultados/
â”‚   â”œâ”€â”€ ver.php                // Tabla de resultados con grÃ¡ficas
â”‚   â”œâ”€â”€ empate.php             // Resolver empates
â”‚   â””â”€â”€ transferir.php         // Confirmar transferencia a comitÃ©
â”œâ”€â”€ empleador/
â”‚   â”œâ”€â”€ designar.php           // Formulario rep. empleador
â”‚   â””â”€â”€ lista.php              // Lista rep. designados
â”œâ”€â”€ documentos/
â”‚   â”œâ”€â”€ acta_apertura.php      // Preview acta apertura
â”‚   â”œâ”€â”€ acta_cierre.php        // Preview acta cierre
â”‚   â”œâ”€â”€ resultados_pdf.php     // Resultados con grÃ¡ficas
â”‚   â””â”€â”€ acta_constitucion.php  // Acta final
â””â”€â”€ firmas/
    â””â”€â”€ estado.php             // Estado de firmas del proceso

app/Views/brigadas/
â”œâ”€â”€ dashboard.php              // Panel de brigadas
â”œâ”€â”€ voluntarios/
â”‚   â”œâ”€â”€ lista.php              // Lista de voluntarios
â”‚   â””â”€â”€ registrar.php          // Formulario registro
â”œâ”€â”€ designacion.php            // Designar brigadistas
â””â”€â”€ acta_designacion.php       // Preview acta

app/Views/vigia_sst/
â”œâ”€â”€ dashboard.php              // Panel vigÃ­a
â”œâ”€â”€ designar.php               // Designar vigÃ­a
â””â”€â”€ acta_designacion.php       // Preview acta
```

---

## Acceso desde Carpeta 1.1.6

La carpeta 1.1.6 en el mÃ³dulo de documentaciÃ³n mostrarÃ¡:

1. **Enlace al Sistema de ComitÃ©s** (nuevo mÃ³dulo)
2. **Documentos subidos** (el consultor descarga PDFs firmados y los sube aquÃ­)

```php
// Vista _tipos/conformacion_copasst.php
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h4 class="mb-1">
            <i class="bi bi-folder-fill text-warning me-2"></i>
            1.1.6 ConformaciÃ³n COPASST/VigÃ­a
        </h4>
    </div>
</div>

<!-- Acceso al mÃ³dulo de elecciones -->
<div class="alert alert-primary">
    <i class="bi bi-box-arrow-up-right me-2"></i>
    <strong>Sistema de ComitÃ©s:</strong>
    <a href="<?= base_url('comites-elecciones/' . $cliente['id_cliente']) ?>"
       class="alert-link" target="_blank">
        Abrir mÃ³dulo de conformaciÃ³n de comitÃ©s
    </a>
</div>

<!-- Documentos subidos manualmente -->
<?= view('documentacion/_components/tabla_documentos', [
    'documentos' => $documentosSSTAprobados ?? []
]) ?>
```

---

## Checklist de ImplementaciÃ³n

### Fase 1: Base de Datos
- [ ] Crear tabla `tbl_procesos_electorales`
- [ ] Crear tabla `tbl_candidatos_eleccion`
- [ ] Crear tabla `tbl_jurados_eleccion`
- [ ] Crear tabla `tbl_votos_eleccion`
- [ ] Crear tabla `tbl_representantes_empleador`
- [ ] Crear tabla `tbl_voluntarios_brigada`
- [ ] Crear tabla `tbl_documentos_proceso_electoral`

### Fase 2: Controladores
- [ ] Crear `ComitesEleccionesController`
- [ ] Crear `BrigadasController`
- [ ] Crear `VigiaSSTController`

### Fase 3: Vistas - COPASST/COCOLAB
- [ ] Dashboard del proceso
- [ ] CRUD Candidatos
- [ ] CRUD Jurados
- [ ] Pantalla de votaciÃ³n pÃºblica (mobile first)
- [ ] Pantalla de resultados
- [ ] DesignaciÃ³n rep. empleador
- [ ] Transferencia a comitÃ©

### Fase 4: Vistas - Brigadas/VigÃ­a
- [ ] Dashboard brigadas
- [ ] Registro voluntarios
- [ ] DesignaciÃ³n brigadistas
- [ ] Dashboard vigÃ­a
- [ ] DesignaciÃ³n vigÃ­a

### Fase 5: Documentos PDF
- [ ] Template Acta de Apertura
- [ ] Template Registro de Votantes
- [ ] Template Acta de Cierre
- [ ] Template Resultados (con grÃ¡ficas)
- [ ] Template Acta de ConstituciÃ³n
- [ ] Template Acta DesignaciÃ³n Brigada
- [ ] Template Acta DesignaciÃ³n VigÃ­a

### Fase 6: IntegraciÃ³n
- [ ] Integrar con sistema de firmas existente
- [ ] Integrar transferencia a `tbl_comite_miembros`
- [ ] Crear vista en carpeta 1.1.6
- [ ] Pruebas de flujo completo

---

## Notas Finales

1. **PerÃ­odo bienal:** El sistema debe alertar cuando un comitÃ© estÃ¡ prÃ³ximo a vencer (2 aÃ±os)
2. **Historial:** Se mantiene historial de todos los procesos electorales
3. **AuditorÃ­a:** Todos los votos son anÃ³nimos pero auditables (hash + IP + timestamp)
4. **Mobile first:** La pantalla de votaciÃ³n debe funcionar perfectamente en celular
5. **Sin quÃ³rum:** No hay mÃ­nimo de participaciÃ³n, la elecciÃ³n es vÃ¡lida con cualquier nÃºmero de votantes

---

Fecha de creaciÃ³n: 2026-02-03
Autor: Claude Code
RevisiÃ³n: v1.0
