Flujo Universal de Documentos IA
Leyenda: ğŸ‘¤ BOTÃ“N/ACCIÃ“N USUARIO â€” âš™ï¸ AUTOMÃTICO SISTEMA â€” ğŸ“‹ MODAL â€” ğŸ”” TOAST â€” ğŸ“§ EMAIL

Actualizado: 2026-02-18
Cambio interno: prompts de secciones ahora vienen de tbl_doc_secciones_config (BD),
no de clases PHP. El UX es idÃ©ntico, excepto que si falta prompt en BD â†’ error toast.


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FASE 0 â€” ACCESO                                                     â•‘
â•‘  Contexto: Carpeta DocumentaciÃ³n â†’ Editor IA                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ‘¤ Clic "Crear con IA" (en carpeta documentaciÃ³n)
                    â”‚
                    â–¼
  âš™ï¸ Redirige a /documentos/generar/{tipo}/{id_cliente}
  âš™ï¸ generarConIA() â†’ DocumentoConfigService lee tipo desde tbl_doc_tipo_configuracion
     â†’ Si tipo no existe en BD: error "Tipo de documento no vÃ¡lido"
     â†’ Si tipo existe: carga secciones desde tbl_doc_secciones_config
                    â”‚
                    â–¼
  âš™ï¸ SweetAlert se dispara automÃ¡ticamente UNA SOLA VEZ por sesiÃ³n
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ğŸ“‹ SWEETALERT: "VerificaciÃ³n de datos"                          â”‚
  â”‚   Muestra: empresa, actividad econÃ³mica, riesgo, trabajadores,  â”‚
  â”‚   peligros, comitÃ©s, PTA (si Tipo B), indicadores (si Tipo B)   â”‚
  â”‚                                                                 â”‚
  â”‚   ğŸ‘¤ [Confirmar y continuar]    ğŸ‘¤ [Generar de todas formas]    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ confirma
                    â–¼
  âš™ï¸ verificacionConfirmada = true (no vuelve a dispararse)
  âš™ï¸ Carga vista generar_con_ia.php con sidebar lateral


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FASE 1 â€” GENERACIÃ“N DE SECCIONES                                    â•‘
â•‘  Contexto: /documentos/generar/{tipo}/{id}  â†’  Sidebar lateral       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  OPCIÃ“N A: GeneraciÃ³n secciÃ³n por secciÃ³n                        â”‚
  â”‚                                                                  â”‚
  â”‚  ğŸ‘¤ Clic "Generar con IA" (botÃ³n por secciÃ³n)                   â”‚
  â”‚       âš™ï¸ ğŸ”” Toast "progress" aparece (Generando...)             â”‚
  â”‚       âš™ï¸ POST /documentos/generar-seccion                        â”‚
  â”‚            PASO 1: Lee nombre, nÃºmero y prompt_ia desde          â”‚
  â”‚                    tbl_doc_secciones_config (BD)                 â”‚
  â”‚            PASO 2: getContextoBase() desde clase PHP             â”‚
  â”‚                    (Tipo B: incluye PTA + indicadores)           â”‚
  â”‚                    (Tipo A: solo datos del cliente)              â”‚
  â”‚            PASO 3: Marco normativo desde tbl_doc_prompts         â”‚
  â”‚            PASO 4: â†’ OpenAI API con prompt de BD                 â”‚
  â”‚                                                                  â”‚
  â”‚       Si secciÃ³n sin prompt_ia en BD:                           â”‚
  â”‚       âš™ï¸ ğŸ”” Toast error "SecciÃ³n sin prompt. Ir a              â”‚
  â”‚                           /listSeccionesConfig"                  â”‚
  â”‚                                                                  â”‚
  â”‚       âš™ï¸ ğŸ”” Toast "ia" (contenido listo)                        â”‚
  â”‚       âš™ï¸ ğŸ”” Toast "database" (tablas consultadas + conteos)     â”‚
  â”‚       âš™ï¸ Contenido aparece en el editor de la secciÃ³n            â”‚
  â”‚                                                                  â”‚
  â”‚  ğŸ‘¤ Edita el contenido generado (editor inline)                 â”‚
  â”‚                                                                  â”‚
  â”‚  ğŸ‘¤ Clic "Guardar secciÃ³n"                                       â”‚
  â”‚       âš™ï¸ POST /documentos/guardar-seccion                        â”‚
  â”‚       âš™ï¸ Si es el 1er guardado: crea tbl_documentos_sst         â”‚
  â”‚            estado = 'borrador'                                   â”‚
  â”‚       âš™ï¸ ğŸ”” Toast "save" confirma                               â”‚
  â”‚       âš™ï¸ BotÃ³n "Enviar a Firmas" se activa (AJAX)               â”‚
  â”‚                                                                  â”‚
  â”‚  ğŸ‘¤ Clic "Aprobar secciÃ³n"                                       â”‚
  â”‚       âš™ï¸ POST /documentos/aprobar-seccion                        â”‚
  â”‚       âš™ï¸ tbl_doc_secciones.aprobado = 1                         â”‚
  â”‚       âš™ï¸ Barra de progreso avanza                                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  OPCIÃ“N B: GeneraciÃ³n en lote                                    â”‚
  â”‚                                                                  â”‚
  â”‚  ğŸ‘¤ Clic "Generar Todo" (sidebar)                               â”‚
  â”‚       âš™ï¸ modoBatch = true (suprime toasts individuales)         â”‚
  â”‚       âš™ï¸ Modal de progreso con barra por secciÃ³n                 â”‚
  â”‚       âš™ï¸ Genera y guarda TODAS las secciones secuencialmente    â”‚
  â”‚       âš™ï¸ Solo toasts de ERROR no se suprimen                    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš™ï¸ AUTOMÃTICO: getEstadoIA() evalÃºa continuamente
      Â¿Todas las secciones tienen aprobado = 1?
                    â”‚ SÃ
                    â–¼
  âš™ï¸ estado_ia calculado = 'aprobado'
  âš™ï¸ BotÃ³n "Aprobar Documento" se HABILITA en sidebar

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  estado en BD = "borrador"  (aÃºn no se ha aprobado) â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FASE 2 â€” APROBACIÃ“N DEL DOCUMENTO                                   â•‘
â•‘  Contexto: Sidebar del editor IA  â†’  estado pasa a 'aprobado'        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ‘¤ Clic "Aprobar Documento" (#btnAprobarDocumento en sidebar)
                    â”‚
                    â–¼
  âš™ï¸ Abre modal #modalAprobarDocumento
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ğŸ“‹ MODAL "Aprobar Documento"                                    â”‚
  â”‚   ğŸ‘¤ Escribe descripciÃ³n del cambio (obligatoria, min 10 chars) â”‚
  â”‚   ğŸ‘¤ Selecciona tipo: [MENOR 1.0â†’1.1] [MAYOR 1.xâ†’2.0]         â”‚
  â”‚        (primera aprobaciÃ³n siempre = 1.0, tipo no importa)      â”‚
  â”‚                                                                 â”‚
  â”‚   ğŸ‘¤ Clic [Confirmar]                                           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
  âš™ï¸ POST /documentos-sst/aprobar-documento
  âš™ï¸ DocumentoVersionService::aprobarVersion() en transacciÃ³n BD:
      â”œâ”€ Marca versiones anteriores â†’ estado='obsoleto' en tbl_doc_versiones_sst
      â”œâ”€ INSERT nuevo registro:
      â”‚     estado='vigente', version_texto='1.0'
      â”‚     contenido_snapshot = JSON completo (foto del documento)
      â”‚     hash_documento = SHA-256
      â””â”€ UPDATE tbl_documentos_sst:
            estado = 'aprobado'
            version = 1, fecha_aprobacion = NOW()
  âš™ï¸ ğŸ”” Toast success "Documento aprobado - versiÃ³n 1.0"

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  estado = "aprobado"  +  versiÃ³n 1.0 vigente         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FASE 3 â€” FIRMA ELECTRÃ“NICA (opcional)                               â•‘
â•‘  Contexto: Sidebar editor IA  o  Toolbar vista web                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  (Disponible desde estados: borrador / generado / aprobado)

  ğŸ‘¤ Clic "Enviar a Firmas" (sidebar o toolbar)
                    â”‚
                    â–¼
  âš™ï¸ FirmaElectronicaController determina firmantes:
      Â¿requiere_delegado_sst = true?
          â†’ 3 firmantes: Delegado â†’ Consultor â†’ RepLegal
      Â¿estandares â‰¤ 10 sin delegado?
          â†’ 2 firmantes: Consultor â†’ RepLegal
      DEFAULT (>10 estandares)
          â†’ 3 firmantes: Consultor â†’ Vigia/COPASST â†’ RepLegal

  âš™ï¸ INSERT tbl_doc_firma_solicitudes (token Ãºnico por firmante, orden)
  âš™ï¸ estado = 'pendiente_firma'
  âš™ï¸ ğŸ“§ Email automÃ¡tico al PRIMER firmante (con enlace Ãºnico)

            Firmante recibe email
                    â”‚
                    â–¼
  ğŸ‘¤ Clic enlace en email â†’ PÃ¡gina pÃºblica de firma
  ğŸ‘¤ Firma: [Dibujar] o [Subir imagen] o [Texto]
  ğŸ‘¤ Clic "Firmar documento"
                    â”‚
                    â–¼
  âš™ï¸ INSERT tbl_doc_firma_evidencias (ip, user_agent, firma_imagen base64)
  âš™ï¸ solicitud firmante N â†’ estado='firmado'
  âš™ï¸ AUTOMÃTICO: Â¿quedan firmantes pendientes?
      â”‚ SÃ â†’ siguiente solicitud pasa a 'pendiente'
      â”‚       ğŸ“§ Email automÃ¡tico al siguiente firmante
      â”‚ NO â†“
  âš™ï¸ estado documento = 'firmado'
  âš™ï¸ publicarDocumentoFirmado() â†’ genera PDF con firmas embebidas

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  estado = "firmado"                                  â”‚
  â”‚  Toolbar muestra: [Ver Firmas] en lugar de [Enviar]  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FLUJO ALTERNATIVO â€” NUEVA VERSIÃ“N                                   â•‘
â•‘  Contexto: Toolbar vista web  â†’  vuelve al editor IA                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  (Solo disponible desde estado 'aprobado')

  ğŸ‘¤ Clic "Iniciar nueva versiÃ³n" (toolbar vista web)
                    â”‚
                    â–¼
  âš™ï¸ Abre modal #modalNuevaVersion
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ğŸ“‹ MODAL "Nueva VersiÃ³n"                                        â”‚
  â”‚   ğŸ‘¤ Selecciona: [MENOR 1.0â†’1.1]  [MAYOR 1.0â†’2.0]             â”‚
  â”‚   ğŸ‘¤ Escribe motivo del cambio (min 10 chars)                   â”‚
  â”‚   âš™ï¸ Preview de nueva versiÃ³n calculada en tiempo real          â”‚
  â”‚                                                                 â”‚
  â”‚   ğŸ‘¤ Clic [Iniciar]    ğŸ‘¤ Clic [Cancelar versiÃ³n]              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Iniciar                              â”‚ Cancelar
         â–¼                                      â–¼
  âš™ï¸ POST /documentos-sst/           âš™ï¸ POST /documentos-sst/
      iniciar-nueva-version               cancelar-nueva-version
  âš™ï¸ estado = 'borrador'             âš™ï¸ estado regresa a 'aprobado'
  âš™ï¸ guarda tipo_cambio_pendiente    âš™ï¸ descarta cambios del borrador
  âš™ï¸ Redirige al editor IA
         â”‚
         â–¼
  â†’ (repite desde FASE 1 â€” solo edita secciones necesarias)
         â”‚
         â–¼ (aprueba)
  âš™ï¸ VersiÃ³n anterior â†’ 'obsoleto'
  âš™ï¸ Nueva versiÃ³n â†’ 'vigente' (1.1 Ã³ 2.0)
  âš™ï¸ estado = 'aprobado'


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FUENTES DE DATOS INTERNAS (sin impacto en UX)                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Al hacer clic "Generar con IA", el backend construye el prompt asÃ­:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  tbl_doc_secciones_config.prompt_ia  â† INSTRUCCIÃ“N PRINCIPAL   â”‚
  â”‚  (editable desde /listSeccionesConfig)                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  PHP class::getContextoBase()        â† DATOS DEL MÃ“DULO        â”‚
  â”‚  Tipo A: solo datos del cliente                                 â”‚
  â”‚  Tipo B: cliente + PTA + indicadores (consulta BD)             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  MarcoNormativoService               â† NORMATIVA               â”‚
  â”‚  (excepto secciÃ³n marco_legal)                                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
             OpenAI API â†’ contenido generado
